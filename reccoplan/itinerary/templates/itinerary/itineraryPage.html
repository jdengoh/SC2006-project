{% extends 'main.html' %}
{% load static %}

{% block title %} Homepage {% endblock title %}

{% block content %}

<h1>Itinerary for {{user}}</h1>

<script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>

    
<script>

    let map;
    let autocomplete;
    function initMap(){
        var input = document.getElementById('pac-input');
        var autocomplete = new google.maps.places.Autocomplete(input);
        map = new google.maps.Map(document.getElementById('map'),
        {
            center:{lat:1.346, lng: 103.684},
            zoom:15,
        });

        const locationButton = document.getElementById('button');
        locationButton.textContent = 'Go to My Location';
        locationButton.classList.add('map-button');
        map.controls[google.maps.ControlPosition.TOP_CENTER].push(locationButton);
        locationButton.addEventListener('click',()=> {
            if(navigator.geolcoation){
                navigator.geolocation.getCurrentPosition(
                    (position => {
                        const pos = {
                            lat: position.coords.latitude,
                            lng: position.coords.longitude,
                        };
                        map.setCenter(pos);
                        var marker = new google.maps.Marker({
                            positions: pos,
                            map:map,
                        });
                        map.setZoom(17);
                    })
                )
            }
        });
        autocomplete.addListener('place_changed',()=>{
            const auto_marker = new google.maps.Marker({
            map,
            anchorPoint: new google.maps.Point(0,0-29),
        });
            auto_marker.setVisible(false);
            const place = autocomplete.getPlace();
            const position = place.geometry.location;
            if(!place.geometry || !place.geometry.location){
                window.alert("No information found for ", + place.name + "." );
            } else {
            if(place.geometry.viewport){
                map.fitBounds(place.geometry.viewport);
            } else {
                map.setCenter(position);
                map.setZoom(17);
            }
            }
            auto_marker.setPosition(position);
            auto_marker.setVisible(true);
        });


    }
    // function initAutocomplete() {
    //     var input = document.getElementById('pac-input');
    //     var autocomplete = new google.maps.places.Autocomplete(input);
        
    // }
    function AutoComplete(map){
        autocomplete = new google.maps.places.Autocomplete(document.getElementById('pac-input'));
        autocomplete.bindTo('bounds',map);


        
        }
</script>

<div class="mapholder">
    <div id="map" style ="height:500px; width:100%;"></div>
</div>

<table class="table-style">
    <thead>
        <tr>
            <th>Rank</th>
            <th>Activity</th>
            <th>Link</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Dom</td>
            <td>6000</td>
            <td>?</td>

        </tr>
        <tr class="active-row">
            <td>Melissa</td>
            <td>5150</td>
            <td>?</td>
        </tr>
        <tr>
            <td>Dom</td>
            <td>6000</td>
            <td>?</td>

        </tr>
        <tr>
            <td>Dom</td>
            <td>6000</td>
            <td>?</td>

        </tr>
        <tr>
            <td>Dom</td>
            <td>6000</td>
            <td>?</td>

        </tr>
        <!-- and so on... -->
    </tbody>
</table>





<table>
    <thread>
        <tr>
            <th>Id</th>
            <th>Name</th>
            <th>Address</th>
            <th>Postal Code</th>
            <th>Lat</th>
            <th>Lon</th>    
        </tr>
    </thread>

    {% for a in location %}
    <tr>
        <th>{{a.id}}</th>
        <th>{{a.name}}</th>
        <th>{{a.address}}</th>
        <th>{{a.postal_code}}</th>
    </tr>

    
    {% endfor %}


</table>
<script async src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDL77OS5N8c5X2khsmnCs-xvOk5z5Ig9oU&libraries=places&callback=initMap&libraries=places&v=weekly"defer ></script>
<!-- <script async src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDL77OS5N8c5X2khsmnCs-xvOk5z5Ig9oU&callback=initMap"> </script> -->
{% endblock content %}
